<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bohemio Academy Pro - Banco de Activos Mentales</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; overflow-x: hidden; }
        .perspective-1000 { perspective: 1000px; }
        .transform-style-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
        .card-inner { transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .glass { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); }
    </style>
</head>
<body class="bg-[#f0f2f5] text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // BASE DE DATOS MAESTRA 0-99 (Sistema Fonético Campayo)
        const DATABASE = [
            { n: 0, l: "R", w: "ARO" }, { n: 1, l: "T, D", w: "HADA" }, { n: 2, l: "N", w: "NOE" }, { n: 3, l: "M", w: "HUMO" }, { n: 4, l: "C, K, Q", w: "K.O." }, { n: 5, l: "L", w: "ALA" }, { n: 6, l: "S, Z", w: "AS" }, { n: 7, l: "F", w: "UFO" }, { n: 8, l: "CH, J, G", w: "HACHA" }, { n: 9, l: "V, B, P", w: "AVE" },
            { n: 10, l: "TR", w: "TORO" }, { n: 11, l: "TT", w: "TETA" }, { n: 12, l: "TN", w: "TUNO" }, { n: 13, l: "TM", w: "TIMO" }, { n: 14, l: "TC", w: "TACO" }, { n: 15, l: "TL", w: "TELA" }, { n: 16, l: "TZ", w: "TAZA" }, { n: 17, l: "TF", w: "TUFO" }, { n: 18, l: "TCH", w: "TECHO" }, { n: 19, l: "TP", w: "TAPA" },
            { n: 20, l: "NR", w: "NORIA" }, { n: 21, l: "ND", w: "NIDO" }, { n: 22, l: "NÑ", w: "NIÑA" }, { n: 23, l: "NM", w: "NEMO" }, { n: 24, l: "NC", w: "NUCA" }, { n: 25, l: "NL", w: "NILO" }, { n: 26, l: "NS", w: "NASA" }, { n: 27, l: "NF", w: "NIFE" }, { n: 28, l: "NCH", w: "NICHO" }, { n: 29, l: "NB", w: "NUBE" },
            { n: 30, l: "MR", w: "MAR" }, { n: 31, l: "MT", w: "MOTO" }, { n: 32, l: "MN", w: "MINA" }, { n: 33, l: "MM", w: "MAMA" }, { n: 34, l: "MC", w: "MOCO" }, { n: 35, l: "ML", w: "MULA" }, { n: 36, l: "MS", w: "MESA" }, { n: 37, l: "MF", w: "MAFIA" }, { n: 38, l: "MCH", w: "MECHA" }, { n: 39, l: "MP", w: "MAPA" },
            { n: 40, l: "CR", w: "CURA" }, { n: 41, l: "CT", w: "CATA" }, { n: 42, l: "CN", w: "CANA" }, { n: 43, l: "CM", w: "CAMA" }, { n: 44, l: "CC", w: "COCO" }, { n: 45, l: "CL", w: "COLA" }, { n: 46, l: "CS", w: "CASA" }, { n: 47, l: "CF", w: "CAFE" }, { n: 48, l: "CCH", w: "COCHE" }, { n: 49, l: "CB", w: "CUBA" },
            { n: 50, l: "LR", w: "LORO" }, { n: 51, l: "LT", w: "LATA" }, { n: 52, l: "LN", w: "LUNA" }, { n: 53, l: "LM", w: "LIMA" }, { n: 54, l: "LC", w: "LACA" }, { n: 55, l: "LL", w: "LULU" }, { n: 56, l: "LS", w: "LOSA" }, { n: 57, l: "LF", w: "ALFA" }, { n: 58, l: "LCH", w: "LUCHO" }, { n: 59, l: "LB", w: "LOBA" },
            { n: 60, l: "SR", w: "SOR" }, { n: 61, l: "ST", w: "SETA" }, { n: 62, l: "SN", w: "SENA" }, { n: 63, l: "SM", w: "SUMA" }, { n: 64, l: "SC", w: "SACO" }, { n: 65, l: "SL", w: "SOLA" }, { n: 66, l: "SS", w: "SESO" }, { n: 67, l: "SF", w: "SOFA" }, { n: 68, l: "SCH", w: "SOJA" }, { n: 69, l: "SB", w: "SAPO" },
            { n: 70, l: "FR", w: "FARO" }, { n: 71, l: "FT", w: "FOTO" }, { n: 72, l: "FN", w: "FAUNA" }, { n: 73, l: "FM", w: "FAMA" }, { n: 74, l: "FC", w: "FOCA" }, { n: 75, l: "FL", w: "FILA" }, { n: 76, l: "FS", w: "FOSA" }, { n: 77, l: "FF", w: "FOFO" }, { n: 78, l: "FCH", w: "FICHA" }, { n: 79, l: "FB", w: "FABA" },
            { n: 80, l: "CHR", w: "CHORRO" }, { n: 81, l: "CHT", w: "CHATA" }, { n: 82, l: "CHN", w: "CHINA" }, { n: 83, l: "CHM", w: "CHAMA" }, { n: 84, l: "CHC", w: "CHICA" }, { n: 85, l: "CHL", w: "CHULO" }, { n: 86, l: "CHS", w: "CHAS" }, { n: 87, l: "CHF", w: "CHUFA" }, { n: 88, l: "CHCH", w: "CHUCHO" }, { n: 89, l: "CHB", w: "CHIVO" },
            { n: 90, l: "BR/PR", w: "BARRA" }, { n: 91, l: "BT", w: "BOTA" }, { n: 92, l: "VN", w: "VINO" }, { n: 93, l: "PM", w: "PUMA" }, { n: 94, l: "VC", w: "VACA" }, { n: 95, l: "VL", w: "VELA" }, { n: 96, l: "VS", w: "VASO" }, { n: 97, l: "VF", w: "VIFA" }, { n: 98, l: "BCH", w: "BACHE" }, { n: 99, l: "PP", w: "PIPA" }
        ];

        const App = () => {
            const [view, setView] = useState('gallery'); // 'gallery', 'links', 'train'
            const [activeSection, setActiveSection] = useState(0);
            const [images, setImages] = useState(() => JSON.parse(localStorage.getItem('saved_images') || '{}'));
            const [stories, setStories] = useState(() => JSON.parse(localStorage.getItem('saved_stories') || '{}'));
            const [apiKey, setApiKey] = useState(localStorage.getItem('gemini_api_key') || '');
            const [showSettings, setShowSettings] = useState(!apiKey);
            const [loading, setLoading] = useState(false);
            const [trainIdx, setTrainIdx] = useState(0);
            const [flipped, setFlipped] = useState(false);
            const [stats, setStats] = useState({ ok: 0, total: 0 });

            useEffect(() => {
                localStorage.setItem('saved_images', JSON.stringify(images));
                localStorage.setItem('saved_stories', JSON.stringify(stories));
            }, [images, stories]);

            const generateImage = async (word, id) => {
                if (!apiKey) { setShowSettings(true); return; }
                setLoading(true);
                try {
                    // DIRECTRIZ CAMPAYO: Inverosímil, exagerado, acción, color.
                    const prompt = `A highly bizarre, surreal, and exaggerated 3D mnemonic illustration of "${word}". 
                    Distorted proportions, cinematic vibrant colors, extreme action, 
                    white studio background, mnemonic art style. Must be shocking and impossible.`;

                    const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            instances: [{ prompt }],
                            parameters: { sampleCount: 1 }
                        })
                    });
                    const data = await res.json();
                    if (data.predictions?.[0]) {
                        setImages(prev => ({ ...prev, [id]: `data:image/png;base64,${data.predictions[0].bytesBase64Encoded}` }));
                    }
                } catch (e) { alert("Error API. Revisa tu clave."); }
                finally { setLoading(false); }
            };

            const updateStory = (id, text) => {
                setStories(prev => ({ ...prev, [id]: text }));
            };

            const sections = ["0-9", "10-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80-89", "90-99"];
            const currentData = DATABASE.slice(activeSection * 10, (activeSection + 1) * 10);

            const startRandomTest = () => {
                setTrainIdx(Math.floor(Math.random() * 100));
                setFlipped(false);
                setView('train');
            };

            return (
                <div className="min-h-screen flex flex-col">
                    {/* Header Estilo Pro */}
                    <header className="bg-slate-900 text-white p-4 sticky top-0 z-[60] shadow-2xl">
                        <div className="max-w-6xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
                            <div className="flex items-center gap-3">
                                <div className="bg-indigo-600 p-2 rounded-2xl shadow-lg">
                                    <i data-lucide="brain" className="w-6 h-6 text-white"></i>
                                </div>
                                <div>
                                    <h1 className="font-black text-xl tracking-tighter uppercase">Bohemio <span className="text-indigo-400">Bank</span></h1>
                                    <span className="text-[10px] font-bold text-slate-400 tracking-[0.3em] uppercase italic">Fotos & Enlaces Campayo</span>
                                </div>
                            </div>
                            
                            <div className="flex bg-slate-800 p-1 rounded-2xl border border-slate-700">
                                <button onClick={() => setView('gallery')} className={`px-4 py-2 rounded-xl text-[10px] font-black transition-all ${view === 'gallery' ? 'bg-indigo-600 text-white' : 'text-slate-400'}`}>BANCO FOTOS</button>
                                <button onClick={() => setView('links')} className={`px-4 py-2 rounded-xl text-[10px] font-black transition-all ${view === 'links' ? 'bg-indigo-600 text-white' : 'text-slate-400'}`}>BANCO ENLACES</button>
                                <button onClick={() => setView('train')} className={`px-4 py-2 rounded-xl text-[10px] font-black transition-all ${view === 'train' ? 'bg-indigo-600 text-white' : 'text-slate-400'}`}>ENTRENAR</button>
                                <button onClick={() => setShowSettings(true)} className="p-2 ml-1 text-slate-500 hover:text-white"><i data-lucide="settings" className="w-4 h-4"></i></button>
                            </div>
                        </div>
                    </header>

                    {/* API Settings */}
                    {showSettings && (
                        <div className="fixed inset-0 bg-slate-900/80 backdrop-blur-md z-[100] flex items-center justify-center p-6">
                            <div className="bg-white rounded-[3rem] p-10 max-w-sm w-full shadow-2xl border border-indigo-100">
                                <h2 className="text-3xl font-black mb-4 uppercase tracking-tighter text-slate-800">Motor AI</h2>
                                <p className="text-xs text-slate-500 mb-6 font-bold uppercase tracking-widest">Configura tu clave Gemini para generar imágenes</p>
                                <input 
                                    type="password"
                                    placeholder="AIzaSy..."
                                    className="w-full p-5 bg-slate-50 border-2 border-slate-100 rounded-3xl mb-6 font-mono text-sm outline-none focus:border-indigo-500 transition-all shadow-inner"
                                    value={apiKey}
                                    onChange={(e) => setApiKey(e.target.value)}
                                />
                                <button 
                                    onClick={() => { localStorage.setItem('gemini_api_key', apiKey); setShowSettings(false); }}
                                    className="w-full py-5 bg-indigo-600 text-white font-black rounded-3xl shadow-xl shadow-indigo-100 hover:bg-indigo-700 uppercase text-xs tracking-[0.2em]"
                                >
                                    Activar Academia
                                </button>
                                <a href="https://aistudio.google.com/app/apikey" target="_blank" className="block mt-6 text-[10px] text-center text-indigo-500 font-black uppercase tracking-widest underline">
                                    Obtener clave gratuita
                                </a>
                            </div>
                        </div>
                    )}

                    <main className="flex-grow p-4 md:p-8 max-w-7xl mx-auto w-full">
                        {/* Selector de Secciones Mnemotécnicas */}
                        {(view === 'gallery' || view === 'links') && (
                            <div className="flex overflow-x-auto gap-2 pb-6 hide-scrollbar snap-x mb-8">
                                {sections.map((s, idx) => (
                                    <button 
                                        key={s}
                                        onClick={() => setActiveSection(idx)}
                                        className={`flex-shrink-0 px-6 py-3 rounded-2xl font-black text-[10px] uppercase tracking-widest transition-all snap-start shadow-sm ${activeSection === idx ? 'bg-indigo-600 text-white' : 'bg-white text-slate-400 border border-slate-200'}`}
                                    >
                                        Bloque {s}
                                    </button>
                                ))}
                            </div>
                        )}

                        {view === 'gallery' ? (
                            <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-6 animate-in fade-in slide-in-from-bottom-4 duration-500">
                                {currentData.map(item => (
                                    <div key={item.n} className="bg-white rounded-[2.5rem] p-3 border border-slate-100 shadow-sm hover:shadow-2xl transition-all duration-500 group relative">
                                        <div className="aspect-square bg-slate-50 rounded-[2rem] relative overflow-hidden flex items-center justify-center border border-slate-100 mb-4">
                                            {images[item.n] ? (
                                                <img src={images[item.n]} className="w-full h-full object-cover animate-in zoom-in-95 duration-700" alt={item.w} />
                                            ) : (
                                                <i data-lucide="image" className="text-slate-200 w-12 h-12"></i>
                                            )}
                                            <div className="absolute top-0 left-0 bg-slate-900 text-white text-[10px] font-black px-3 py-1.5 rounded-br-2xl">{item.n}</div>
                                            <button 
                                                onClick={() => generateImage(item.w, item.n)}
                                                className="absolute inset-0 bg-indigo-900/60 backdrop-blur-sm opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-2"
                                            >
                                                <i data-lucide="sparkles" className="text-white w-6 h-6"></i>
                                                <span className="text-white text-[8px] font-black uppercase text-center px-4 tracking-widest">Generar Foto Campayo</span>
                                            </button>
                                        </div>
                                        <div className="text-center pb-2">
                                            <h3 className="text-xs font-black uppercase tracking-tighter text-slate-800">{item.w}</h3>
                                            <p className="text-[9px] font-mono font-bold text-indigo-400 mt-1 uppercase opacity-60 tracking-widest">{item.l}</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        ) : view === 'links' ? (
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 animate-in fade-in duration-500">
                                {currentData.map(item => (
                                    <div key={item.n} className="bg-white rounded-[2.5rem] p-6 border border-slate-100 shadow-sm flex gap-6 items-start hover:shadow-xl transition-all">
                                        <div className="w-24 h-24 bg-indigo-50 rounded-[1.5rem] flex-shrink-0 flex items-center justify-center relative overflow-hidden border border-indigo-100 shadow-inner">
                                            {images[item.n] ? (
                                                <img src={images[item.n]} className="w-full h-full object-cover" alt={item.w} />
                                            ) : (
                                                <span className="text-3xl font-black text-indigo-200">{item.n}</span>
                                            )}
                                        </div>
                                        <div className="flex-grow">
                                            <div className="flex justify-between items-center mb-3">
                                                <h3 className="font-black text-slate-800 uppercase tracking-tighter text-lg">{item.n} — {item.w}</h3>
                                                <span className="text-[10px] font-mono font-bold text-indigo-500 bg-indigo-50 px-3 py-1 rounded-full">{item.l}</span>
                                            </div>
                                            <textarea 
                                                className="w-full bg-slate-50 border-none rounded-2xl p-4 text-xs font-medium placeholder:text-slate-300 focus:ring-2 focus:ring-indigo-100 transition-all resize-none min-h-[80px]"
                                                placeholder="Escribe tu asociación inverosímil aquí (Enlace)..."
                                                value={stories[item.n] || ''}
                                                onChange={(e) => updateStory(item.n, e.target.value)}
                                            ></textarea>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        ) : (
                            <div className="max-w-md mx-auto py-4 animate-in zoom-in-95 duration-500 text-center">
                                <div className="flex justify-between items-center mb-8 px-6">
                                    <div className="text-[10px] font-black uppercase text-indigo-600 bg-white px-5 py-2 rounded-full border border-indigo-100 flex items-center gap-2 shadow-sm">
                                        <i data-lucide="trophy" className="w-3 h-3 text-amber-500"></i> {stats.ok} / {stats.total}
                                    </div>
                                    <button onClick={startRandomTest} className="text-indigo-600 bg-white p-2 rounded-full shadow-sm hover:rotate-180 transition-transform duration-500"><i data-lucide="refresh-cw" className="w-5 h-5"></i></button>
                                </div>

                                <div className="w-full aspect-[3/4] perspective-1000 group">
                                    <div 
                                        className={`relative w-full h-full card-inner transform-style-3d cursor-pointer ${flipped ? 'rotate-y-180' : ''}`}
                                        onClick={() => !flipped && setFlipped(true)}
                                    >
                                        {/* Cara Número */}
                                        <div className="absolute inset-0 bg-indigo-700 rounded-[4rem] shadow-2xl flex flex-col items-center justify-center text-white backface-hidden border-[15px] border-indigo-600/50 overflow-hidden">
                                            <div className="absolute top-12 opacity-30 font-black text-[10px] tracking-[0.5em] uppercase">Bohemio Academy</div>
                                            <span className="text-[12rem] font-black leading-none drop-shadow-2xl">{DATABASE[trainIdx].n}</span>
                                            <p className="mt-8 text-indigo-200 text-[10px] font-black uppercase tracking-[0.5em] opacity-60">Visualiza la escena</p>
                                        </div>
                                        
                                        {/* Cara Respuesta */}
                                        <div className="absolute inset-0 bg-white rounded-[4rem] shadow-2xl flex flex-col items-center justify-center rotate-y-180 backface-hidden p-10 border-4 border-indigo-600">
                                            <div className="w-full aspect-square bg-slate-50 rounded-[3rem] mb-8 overflow-hidden flex items-center justify-center border-2 border-slate-100 shadow-inner">
                                                {images[trainIdx] ? (
                                                    <img src={images[trainIdx]} className="w-full h-full object-cover" alt="mnemonic" />
                                                ) : (
                                                    <i data-lucide="image" className="text-slate-100 w-24 h-24"></i>
                                                )}
                                            </div>
                                            <h2 className="text-5xl font-black uppercase text-indigo-900 tracking-tighter leading-none mb-2">{DATABASE[trainIdx].w}</h2>
                                            <p className="text-[10px] font-black text-slate-400 uppercase tracking-[0.3em] mb-4">"{stories[trainIdx] || 'Sin historia guardada'}"</p>
                                            <span className="text-2xl font-mono text-indigo-600 font-black tracking-widest">{DATABASE[trainIdx].l}</span>
                                        </div>
                                    </div>
                                </div>

                                {flipped && (
                                    <div className="grid grid-cols-2 gap-4 mt-10">
                                        <button 
                                            onClick={() => { setStats(s => ({...s, total: s.total+1})); startRandomTest(); }}
                                            className="py-5 bg-white text-slate-400 font-black rounded-[2.5rem] border-2 border-slate-100 uppercase text-[10px] tracking-widest shadow-sm active:scale-95 transition-all"
                                        >
                                            Repasar
                                        </button>
                                        <button 
                                            onClick={() => { setStats(s => ({...s, ok: s.ok+1, total: s.total+1})); startRandomTest(); }}
                                            className="py-5 bg-indigo-600 text-white font-black rounded-[2.5rem] shadow-xl shadow-indigo-100 active:scale-95 transition-all uppercase text-[10px] tracking-widest flex items-center justify-center gap-2"
                                        >
                                            <i data-lucide="check" className="w-4 h-4"></i> ¡Lo tengo!
                                        </button>
                                    </div>
                                )}
                            </div>
                        )}

                        {(view === 'gallery' || view === 'links') && (
                            <div className="flex justify-center pt-16">
                                <button 
                                    onClick={startRandomTest}
                                    className="bg-slate-900 text-white px-12 py-5 rounded-full font-black text-xs uppercase tracking-[0.3em] shadow-2xl flex items-center gap-4 hover:bg-indigo-600 transition-all active:scale-95 group"
                                >
                                    <i data-lucide="shuffle" className="w-5 h-5 group-hover:rotate-180 transition-transform duration-500"></i> Simulacro Mental Pro
                                </button>
                            </div>
                        )}
                    </main>

                    {/* Loader Campayo */}
                    {loading && (
                        <div className="fixed bottom-10 left-1/2 -translate-x-1/2 glass px-10 py-6 rounded-[2.5rem] shadow-2xl flex items-center gap-5 z-[200] border border-white animate-in zoom-in-95 duration-300">
                            <i data-lucide="refresh-cw" className="animate-spin text-indigo-600 w-7 h-7"></i>
                            <div className="flex flex-col">
                                <span className="text-xs font-black uppercase tracking-[0.2em] text-slate-800 leading-none">IA Bohemio Academy</span>
                                <span className="text-[10px] text-slate-400 font-bold tracking-widest mt-2 uppercase italic">Esculpiendo asociación inverosímil...</span>
                            </div>
                        </div>
                    )}

                    <footer className="bg-white border-t border-slate-100 p-8 text-center mt-auto">
                        <p className="text-[10px] font-black text-slate-300 uppercase tracking-[0.4em]">
                            Kaizen: Mejora un 1% cada día. Método Campayo: Visualiza con emoción.
                        </p>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
        setInterval(() => window.lucide?.createIcons(), 500);
    </script>
</body>
</html>